# SPID CIE OIDC NodeJS Relying Party Example Project with Express and React

This project showcases the relying party.

## Requirements:

- [python](https://www.python.org/downloads/) 3.x or higher
- [node](https://nodejs.org/en/) 16.x or higher
- [yarn](https://yarnpkg.com/) 1.22.x or higher

## How to run

- run the povider [federation](https://github.com/italia/spid-cie-oidc-django)
  - follow these [instructions](https://github.com/italia/spid-cie-oidc-django/blob/main/docs/SETUP.md)
  - the project should run on [http://127.0.0.1:8000](http://127.0.0.1:8000), keep it running

- cd into relying party directory, your local directory that corresponds to [this](https://github.com/italia/spid-cie-oidc-nodejs/tree/main/relying-party)
  - run this command `yarn build && yarn link`

- cd into this directory, your local directory that corresponds to [this](https://github.com/italia/spid-cie-oidc-nodejs/tree/main/examples/express-react-relying-party)
  - run this command `yarn link spid-cie-oidc && yarn build && yarn start`
  - this will start the relying party server on [http://127.0.0.1:3000](http://127.0.0.1:3000), keep it running

- do the onboarding process
  - register the relying party [here](http://127.0.0.1:8000/admin/spid_cie_oidc_authority/federationdescendant/add)
    - paste in the federation related public jwks (you find them [here](public.jwks.json), they get autogenerated for you if not provided)
    - set isActive to true
  - create new profile [here](http://127.0.0.1:8000/admin/spid_cie_oidc_authority/federationentityassignedprofile/add/)
    - usually you want a private or public profile as for spec
    - after creation you review the profiles
    - copy trust_marks from here to `trust_marks.json` in this direcotry

- restart relying party (the one running on port 3000)

- visit [http://127.0.0.1:3000](http://127.0.0.1:3000) to try out the application

### Docker

A docker image containing this example can be built a run:
  - `docker-compose up`
  - visit `http://127.0.0.1:3000`